/**
 * Tweetie: A simple Twitter feed plugin
 * Author: Sonny T. <hi@sonnyt.com>, sonnyt.com
 */(function(e){"use strict";e.fn.twittie=function(){var t=arguments[0]instanceof Object?arguments[0]:{},n=typeof arguments[0]=="function"?arguments[0]:arguments[1],r=e.extend({username:null,list:null,count:10,hideReplies:!1,dateFormat:"%b/%d/%Y",template:"{{date}} - {{tweet}}",apiPath:"api/tweet.php"},t);r.list&&!r.username&&e.error("If you want to fetch tweets from a list, you must define the username of the list owner.");var i=function(e){var t=e.replace(/(https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w\/_\.]*(\?\S+)?)?)?)/ig,'<a href="$1" target="_blank" title="Visit this link">$1</a>').replace(/#([a-zA-Z0-9_]+)/g,'<a href="http://twitter.com/search?q=%23$1&amp;src=hash" target="_blank" title="Search for #$1">#$1</a>').replace(/@([a-zA-Z0-9_]+)/g,'<a href="http://twitter.com/$1" target="_blank" title="$1 on Twitter">@$1</a>');return t},s=function(e){var t=e.split(" ");e=new Date(Date.parse(t[1]+" "+t[2]+", "+t[5]+" "+t[3]+" UTC"));var n=["January","February","March","April","May","June","July","August","September","October","November","December"],i={"%d":e.getDate(),"%m":e.getMonth()+1,"%b":n[e.getMonth()].substr(0,3),"%B":n[e.getMonth()],"%y":String(e.getFullYear()).slice(-2),"%Y":e.getFullYear()},s=r.dateFormat,o=r.dateFormat.match(/%[dmbByY]/g);for(var u=0,a=o.length;u<a;u++)s=s.replace(o[u],i[o[u]]);return s},o=function(e){var t=r.template,n=["date","tweet","avatar","url","retweeted","screen_name"];for(var i=0,s=n.length;i<s;i++)t=t.replace(new RegExp("{{"+n[i]+"}}","gi"),e[n[i]]);return t};this.html("<span>Loading...</span>");var u=this;e.getJSON(r.apiPath,{username:r.username,list:r.list,count:r.count,exclude_replies:r.hideReplies},function(e){u.find("span").fadeOut("fast",function(){u.html("<ul></ul>");for(var t=0;t<r.count;t++){if(!e[t])break;var a={date:s(e[t].created_at),tweet:e[t].retweeted?i("RT @"+e[t].user.screen_name+": "+e[t].retweeted_status.text):i(e[t].text),avatar:'<img src="'+e[t].user.profile_image_url+'" />',url:"http://twitter.com/"+e[t].user.screen_name+"/status/"+e[t].id_str,retweeted:e[t].retweeted,screen_name:i("@"+e[t].user.screen_name)};u.find("ul").append("<li>"+o(a)+"</li>")}typeof n=="function"&&n()})})}})(jQuery);